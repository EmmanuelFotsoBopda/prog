#!/usr/bin/env python
# coding: utf-8

# In[1]:


import os

# Discount definitions according to business logic [cite: 776, 777]
CAT_DISCOUNTS = {"Electronics": 0.10, "Clothing": 0.15, "Books": 0.05, "Home": 0.12}
TIER_DISCOUNTS = {"Premium": 0.05, "Standard": 0.00, "Budget": 0.02}

def process_pricing():
    input_file = "products.txt"
    output_file = "pricing_report.txt"
    total_processed = 0
    total_discount_pct = 0

    # Ensure files are handled safely using the 'with' statement [cite: 772]
    try:
        with open(input_file, "r") as f_in, open(output_file, "w") as f_out:
            # Writing report headers for aligned output 
            f_out.write(f"{'Product':<25} | {'Base':>8} | {'Disc %':>8} | {'Disc Amt':>8} | {'Final':>10}\n")
            f_out.write("-" * 75 + "\n")

            for line in f_in:
                try:
                    # Parsing CSV format: Name, Price, Category, Tier [cite: 764, 765]
                    parts = [p.strip() for p in line.strip().split(",")]
                    if len(parts) != 4: continue
                    
                    name, base_price_str, category, tier = parts
                    base_price = float(base_price_str)
                    
                    # Calculating additive discounts [cite: 763, 766]
                    disc_pct = CAT_DISCOUNTS.get(category, 0) + TIER_DISCOUNTS.get(tier, 0)
                    disc_amt = base_price * disc_pct
                    final_price = base_price - disc_amt
                    
                    total_processed += 1
                    total_discount_pct += disc_pct
                    
                    # Writing formatted product row [cite: 770, 787]
                    f_out.write(f"{name:<25} | {base_price:>8.2f} | {disc_pct:>7.0%} | {disc_amt:>8.2f} | {final_price:>10.2f}\n")
                
                except ValueError:
                    # Handling invalid price formats within the file [cite: 774, 775]
                    print(f"Skipping line due to invalid price format: {line.strip()}")

        # Console summary of processing statistics [cite: 779, 788]
        if total_processed > 0:
            avg_disc = (total_discount_pct / total_processed) * 100
            print(f"Total products processed: {total_processed}")
            print(f"Average discount applied: {avg_disc:.2f}%")

    except FileNotFoundError:
        print(f"Error: The input file '{input_file}' was not found.") # [cite: 775]
    except PermissionError:
        print(f"Error: Write permissions denied for '{output_file}'.") # [cite: 774]

if __name__ == "__main__":
    process_pricing()


# In[ ]:




